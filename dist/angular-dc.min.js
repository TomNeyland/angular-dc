/**
 * angular-dc
 * @version v0.0.8 - 2015-04-14
 * @link https://github.com/TomNeyland/angular-dc
 * @author Tom Neyland <>
 * @license Apache License, http://www.opensource.org/licenses/Apache
 */
!function(a,b){"function"==typeof define&&define.amd?define(["angular","dc","lodash","d3"],function(c,d,e,f){return a.angularDc=b(c,d,e,f)}):"object"==typeof exports?module.exports=b(require("angular"),require("dc"),require("lodash"),require("d3")):a.angularDc=b(angular,dc,_,d3)}(this,function(a,b,c,d){"use strict";var e=a.module("angularDc",[]);return e.directive("dcChart",["$timeout",function(c){function e(a,c,d,e){var h=c[0],i=d.dcChart,j=d.dcChartGroup||void 0,k=b[i],l=k(h,j),m=f(l);e=g(a,d,m),"options"in e&&(e=_.merge(e,e.options),e.options=void 0),"name"in e&&(a[e.name]=l,e.name=void 0),l.options(e);var n=_({renderlet:e.onRenderlet,preRender:e.onPreRender,postRender:e.onPostRender,preRedraw:e.onPreRedraw,postRedraw:e.onPostRedraw,filtered:e.onFiltered,zoomed:e.onZoomed}).omit(_.isUndefined);return n.each(function(a,b){l.on(b,a)}).value(),_.isFunction(e.postSetupChart)&&e.postSetupChart(l,e),l}function f(a){return _(a).functions().concat(h).map(function(a){return"dc"+a.charAt(0).toUpperCase()+a.substring(1)}).value()}function g(a,b,c){return _(b.$attr).keys().intersection(c).map(function(c){var d=a.$eval(b[c]);return"dc"===c.substring(0,2)&&(c=c.charAt(2).toLowerCase()+c.substring(3)),[c,d]}).zipObject().value()}var h=["name","onRenderlet","onFiltered","onPostRedraw","onPostRender","onPreRedraw","onPreRender","onZoomed","postSetupChart"];return{restrict:"A",link:function(f,g,h){var i=!1;f.dc=b,f.d3=d,f.DateTime=function(a,b,c,d,e,f){return new Date(a,b,c,d,e,f)},f.Date=function(a,b,c){return new Date(a,b,c)};var j=f.$watch(function(){var a=_(h.$attr).keys().filter(function(a){return"dc"===a.substring(0,2)&&"dcChart"!==a&&"dcChartGroup"!==a}).map(function(a){try{var b=f.$eval(h[a]);if(_.isUndefined(b))throw new Error(h[a]+" is undefined");return b}catch(c){if(i)throw console.log("unable to eval"+a+":"+h[a]),c;return void 0}});return a.any(_.isUndefined)?void 0:a.value()},function(c){if(!_.isUndefined(c)){j();var d=e(f,g,h),i=a.element(g[0].querySelector("a.reset"));i.on("click",function(){d.filterAll(),b.redrawAll()}),i.attr("href","javascript:;"),i.css("display","none"),d.render()}});c(function(){i=!0},2e3)}}}]),e.directive("dcSelect",[function(){return{restrict:"E",scope:{dcDimension:"=",allLabel:"@"},template:'<select class="form-control" ng-model="selectModel" ng-options="d.key for d in selectOptions">',link:function(a,c,d){return a.$watch("dcDimension",function(c){var d,e;null!==c&&(e=b.baseMixin({}),e.dimension(c),e.group(c),e._doRender=function(){},e._doRedraw=function(){},a.selectModel={key:a.allLabel},d=c.group().orderNatural().all(),a.selectOptions=[a.selectModel].concat(d))}),a.$watch("selectModel",function(c){null!==a.dcDimension&&(a.dcDimension.filter(null!==c&&c.key!==a.allLabel?function(a){return a===c.key}:null),b.redrawAll())})}}}]),e});